<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<title>Login page</title>
<style>
.alert-danger {
	color: red;
}
</style>
<style type="text/css">
	table {
		 text-align: center;
 		 border-collapse: collapse;
	}
	th, td {
  		border: solid 2px black;
  	}
	thead, tbody {
  		display: block;
	}
	tbody {
  		overflow-x: hidden;
  		overflow-y: scroll;
 		height: 250px;
	}

	.table_checkbox {
		width: 25px;
	}
	.candidate_id {
		width: 45px;
	}
	.candidate_name {
		width: 140px;
	}
	.gender {
		width: 60px;
	}
	.edu_back {
		width: 200px;
	}
	.agent {
		width: 110px;
	}
	.referrer {
		width: 80px;
	}
	.slc_status {
		width: 100px;
	}
	.slc_status_dtl {
		width: 80px;
	}
	.slc_date {
		width: 160px;
	}

	.candidate_id_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		border-color:#fff;
		height: 26px;
		width: 45px;

	}
	.candidate_name_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 140px;
	}
	.gender_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 60px;
	}
	.edu_back_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 200px;
	}
	.agent_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 110px;
	}
	.referrer_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 80px;
	}
	.slc_status_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 100px;
	}
	.slc_status_dtl_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 80px;
	}
	.slc_date_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
		width: 160px;
	}

	.sort_button {
		font-weight: bold;
		background-color: #fff;
		border-style: none;
		height: 26px;
	}

</style>
<script type="text/javascript">
	function conditionsFormSubmit() {
		document.conditionsForm.submit();
	}

	function submitAction(url) {
		document.updateForm.action = '/recruit/candidates' + url;
		document.updateForm.submit();
	}

	function buttonCheck() {
	  var checkedNum = 0;
	  var flag = true;
	  var cId = document.updateForm.checkbox;
	  var slcStatus = document.getElementsByClassName("slc_status");
	  var slcStatusChecked = [];
	  var cndButton = document.getElementById("candidateButton");
	  var alcButton = document.getElementById("selectionButton");
	  var mltButton = document.getElementById("multipleButton");


	  for (var i = 0; i < cId.length; i++) {
	    if (cId[i].checked) {
	    	checkedNum += 1;
	    	slcStatusChecked.push(slcStatus[i+1].textContent);
	    }
	  }
	  for (var i = 0; i <slcStatusChecked.length - 1; i++) {
	  	if (slcStatusChecked[i] != slcStatusChecked[i+1]) {
	  		flag = false;
	  		break;
	  	}
	  }

	  if (checkedNum == 0) {
		cndButton.disabled = true;
		alcButton.disabled = true;
		mltButton.disabled = true;
	  } else if (checkedNum == 1) {
		  cndButton.disabled = false;
		  alcButton.disabled = false;
		  mltButton.disabled = false;
	  } else {
		  cndButton.disabled = true;
		  alcButton.disabled = true;
		  if (flag) {
		  	mltButton.disabled = false;
	  	  } else {
	  		mltButton.disabled = true;
	  	  }
	  }

	}

	function checkManagement() {
		var cId = document.updateForm.checkbox;
		var checkAll = document.getElementById("checkAll");

		if (checkAll.checked) {
			for (var i = 0; i < cId.length; i++) {
				cId[i].checked = true;
			}
		} else {
			for (var i = 0; i < cId.length; i++) {
				cId[i].checked = false;
			}
		}

	}

	function sort(param) {
		var order =  document.conditionsForm.order;
		var direction = document.conditionsForm.direction;

		if (order.value == param) {
			if (direction.value == 1) {
				direction.value = 2;
			} else if (direction.value == 2) {
				direction.value = 1;
			}
		} else {
			order.value = param;
			direction.value = 1;
		}

		document.conditionsForm.submit();

	}

	function sortKeep() {
		var orderValue =  document.conditionsForm.order.value;
		var directionValue = document.conditionsForm.direction.value;
		var sort = document.getElementsByClassName("sort");

		if (directionValue == 1) {
			sort[orderValue - 1].textContent = "▼";
		} else if (directionValue == 2) {
			sort[orderValue - 1].textContent = "▲";
		}

	}

</script>
</head>
<body onload="sortKeep()">
	<h2>候補者一覧画面</h2>

	<a th:href="@{/recruit/candidates/regist}">新規登録</a><br/><br/>

	<form name="conditionsForm" th:action="@{/recruit/candidates}" th:method="get" th:object="${conditionsForm}">
		<div>
			<label>選考ステータス</label>
			<select th:field="*{slcStatusId}">
				<option value="0">一覧</option>
				<option th:each="slcStatus: ${slcStatusList}" th:value="${slcStatus.slcStatusId}" th:text="${slcStatus.slcStatusName}">
			</select>
		</div>
		<div>
			<label>選考ステータス詳細</label>
			<select th:field="*{slcStatusDtlId}">
				<option value="0">一覧</option>
				<option value="-1">要対応</option>
				<option th:each="slcStatusDtl: ${slcStatusDtlList}" th:value="${slcStatusDtl.slcStatusDtlId}" th:text="${slcStatusDtl.slcStatusDtlName}">
			</select>
		</div>
		<input type="hidden" th:field="*{order}">
		<input type="hidden" th:field="*{direction}">

		<div>
			<label>日付検索</label>
			<input type="date" th:field="*{from}">～
			<input type="date" th:field="*{to}">
			<input type="submit" value="検索">
		</div>
	</form>
	<form th:action="@{/recruit/candidates}">
		<input type="submit" value="クリア">
	</form><br/>

	<form name="updateForm" th:action="@{/recruit/candidates/selection}" th:method="get">
		<button id="candidateButton" type="button" disabled onclick="submitAction('/update')">候補者情報変更</button>
		<button id="selectionButton" type="button" disabled onclick="submitAction('/selection')">選考情報変更</button>
		<button id="multipleButton" type="button" disabled onclick="submitAction('/multiple')">一括管理</button>
	<table>
		<thead>
		<tr>
			<th class="table_checkbox">
				<input type="checkbox" id="checkAll" onchange="checkManagement()"></th>

			<th class="candidate_id">
				<button class="candidate_id_button" type="button" onclick="sort(1)">
					ID<span class="sort"></span>
				</button>
			</th>
			<th class="candidate_name">
				<button class="candidate_name_button" type="button" onclick="sort(2)">
					氏名<span class="sort"></span>
				</button>
			</th>
			<th class="gender">
				<button class="gender_button" type="button" onclick="sort(3)">
					性別<span class="sort"></span>
				</button>
			</th>
			<th class="edu_back">
				<button class="edu_back_button" type="button" onclick="sort(4)">
					学歴<span class="sort"></span>
				</button></th>
			<th class="agent">
				<button  class="agent_button" type="button" onclick="sort(5)">
					エージェント<span class="sort"></span>
				</button>
			</th>
			<th class="referrer">
				<button class="referrer_button" type="button" onclick="sort(6)">
					紹介元<span class="sort"></span>
				</button>
			</th>
			<th class="slc_status">
				<button class="slc_status_button" type="button" onclick="sort(7)">
					ステータス<span class="sort"></span>
				</button>
			</th>
			<th class="slc_status_dtl">
				<button class="slc_status_dtl_button" type="button" onclick="sort(8)">
					詳細<span class="sort"></span>
				</button>
			</th>
			<th class="slc_date">
				<button class="slc_date_button" type="button" onclick="sort(9)">
					選考日程<span class="sort"></span>
				</button>
			</th>
		</tr>
		</thead>
		<tbody>
		<tr th:each="candidate: ${candidates}" th:object="${candidate}">
			<td class="table_checkbox">
				<input type="checkbox" id="checkbox" name="candidateId" th:value="*{candidateId}" onchange="buttonCheck()">
			</td>
			<td class="candidate_id" th:text="*{candidateId}"></td>
			<td class="candidate_name" th:text="*{candidateName}"></td>
			<td class="gender" th:text="*{gender == 1} ? 男性 : 女性"></td>
			<td class="edu_back" th:text="*{eduBack}"></td>
			<td class="agent" th:text="*{agentName}"></td>
			<td class="referrer" th:text="*{referrerName}"></td>
			<td class="slc_status" th:text="*{slcStatusName}"></td>
			<td class="slc_status_dtl" th:text="*{slcStatusDtlName}"></td>
			<td class="slc_date"><div th:if="*{slcStatusDtlId == 2 || slcStatusDtlId == 6 || slcStatusDtlId == 8}" th:text="*{slcDate}"></div></td>

		</tr>
		</tbody>
	</table>
	</form>
	<br/>

	<a href="#">TOPに戻る</a>
</body>
</html>

